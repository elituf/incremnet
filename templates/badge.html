<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:,">
    <title>incremnet badge</title>
    <link rel="preload" href="data:image/png;base64,<%= image %>" as="image">
    <style>
        * {
            user-select: none;
        }

        html {
            margin: 0;
            overflow: hidden;
            color-scheme: light dark;
        }

        body {
            margin: 0;
        }

        img {
            image-rendering: pixelated;
        }

        span {
            position: absolute;
            font-size: 14px;
            font-family: Arial, sans-serif;
            color: black;
            top: 4px;
            left: 6px;
        }

        area {
            cursor: pointer;
        }
    </style>

    <script>
        async function incrementBadge() {
            try {
                const request = await fetch('/badge?key=<%= key %>', { method: 'POST' });
                if (request.ok) {
                    const response = await request.json();
                    const value = document.getElementById('value');
                    value.textContent = response.value;
                    value.style.color = 'grey';
                    setTimeout(() => {
                        value.style.color = '';
                    }, 100);
                } else {
                    console.error('failed to incremnet badge');
                }
            } catch (error) {
                console.error(error);
            }
        }
    </script>
</head>

<body>
    <img src="data:image/png;base64,<%= image %>" usemap="#image-map">
    <span id="value">
        <%= value %>
    </span>
    <map name="image-map">
        <area alt="incremnet this page" title="incremnet this page" coords="69,4,84,19" shape="rect"
            onclick="incrementBadge()">
        <area target="_blank" alt="incremnet" title="incremnet" href="https://increm.net" coords="20,21,67,30"
            shape="rect">
    </map>
</body>

</html>
